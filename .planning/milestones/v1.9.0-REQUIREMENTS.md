# Requirements: v1.9.0 Codebase Intelligence System

## v1 Requirements

### Indexing (INDEX)

- [x] **INDEX-01**: PostToolUse hook indexes files after Write/Edit operations
- [x] **INDEX-02**: Index tracks file paths, exports, and imports
- [x] **INDEX-03**: Index stored in `.planning/intel/index.json`
- [x] **INDEX-04**: Hook fails silently on any error (never blocks Claude)
- [x] **INDEX-05**: Index updates incrementally (add/modify, not full rebuild)

### Context Injection (CTX)

- [ ] **CTX-01**: SessionStart hook injects codebase summary into Claude's context
- [ ] **CTX-02**: Summary includes detected conventions (naming, directory patterns)
- [ ] **CTX-03**: Summary includes directory structure overview
- [ ] **CTX-04**: Summary includes key exports by category (classes, functions, consts)
- [ ] **CTX-05**: Summary wrapped in `<codebase-intelligence>` tags

### Convention Detection (CONV)

- [ ] **CONV-01**: Detect naming patterns (PascalCase, camelCase, kebab-case, snake_case)
- [ ] **CONV-02**: Detect suffix patterns (*.service.ts, *.controller.ts, *.test.ts)
- [ ] **CONV-03**: Detect directory purpose patterns (src/services/, src/components/)
- [ ] **CONV-04**: Confidence threshold: 5+ files required before pattern is detected
- [ ] **CONV-05**: Confidence threshold: 70%+ match rate required
- [x] **CONV-06**: Conventions stored in `.planning/intel/conventions.json`

### Brownfield Analysis (BROWN)

- [ ] **BROWN-01**: `/gsd:analyze-codebase` command scans existing codebase
- [ ] **BROWN-02**: Command works without `/gsd:new-project` (standalone)
- [ ] **BROWN-03**: Creates `.planning/intel/` directory structure
- [ ] **BROWN-04**: Populates index.json with full codebase analysis
- [ ] **BROWN-05**: Generates conventions.json from detected patterns
- [ ] **BROWN-06**: Hooks continue incremental learning after initial analysis

### GSD Integration (INT)

- [ ] **INT-01**: `install.js` registers intel hooks in settings.json
- [ ] **INT-02**: `/gsd:new-project` creates `.planning/intel/` structure
- [ ] **INT-03**: Subagent prompts (planner, executor) include codebase context
- [ ] **INT-04**: Summary regenerated when conventions change

### Documentation (DOC)

- [ ] **DOC-01**: README.md updated with codebase intelligence section
- [ ] **DOC-02**: help.md updated with `/gsd:analyze-codebase` command
- [ ] **DOC-03**: GSD-STYLE.md updated with intel patterns

## v2 Requirements (Deferred)

- PreToolUse convention advisory hook (warn before Write if pattern mismatch)
- `/gsd:intel-correct` command for manual convention corrections
- Exception tracking (intentional deviations from conventions)
- Confidence adjustment based on exceptions
- `/gsd:resume-work` decimal phase handling (from v1.8.0)

## Out of Scope

| Exclusion | Reason |
|-----------|--------|
| Semantic embeddings / vector search | Requires API calls, violates zero-API constraint |
| Cross-project convention sharing | Future milestone scope |
| Framework auto-detection | Future milestone scope |
| IDE-like navigation features | Not GSD's domain |
| Native dependencies (tree-sitter) | Breaks installation simplicity |
| Blocking hooks (reject writes) | Advisory-only principle |

## Traceability

| Requirement | Phase | Status |
|-------------|-------|--------|
| INDEX-01 | Phase 1 | Complete |
| INDEX-02 | Phase 1 | Complete |
| INDEX-03 | Phase 1 | Complete |
| INDEX-04 | Phase 1 | Complete |
| INDEX-05 | Phase 1 | Complete |
| CTX-01 | Phase 2 | Pending |
| CTX-02 | Phase 2 | Pending |
| CTX-03 | Phase 2 | Pending |
| CTX-04 | Phase 2 | Pending |
| CTX-05 | Phase 2 | Pending |
| CONV-01 | Phase 2 | Pending |
| CONV-02 | Phase 2 | Pending |
| CONV-03 | Phase 2 | Pending |
| CONV-04 | Phase 2 | Pending |
| CONV-05 | Phase 2 | Pending |
| CONV-06 | Phase 1 | Complete |
| BROWN-01 | Phase 3 | Pending |
| BROWN-02 | Phase 3 | Pending |
| BROWN-03 | Phase 3 | Pending |
| BROWN-04 | Phase 3 | Pending |
| BROWN-05 | Phase 3 | Pending |
| BROWN-06 | Phase 3 | Pending |
| INT-01 | Phase 3 | Pending |
| INT-02 | Phase 3 | Pending |
| INT-03 | Phase 3 | Pending |
| INT-04 | Phase 2 | Pending |
| DOC-01 | Phase 3 | Pending |
| DOC-02 | Phase 3 | Pending |
| DOC-03 | Phase 3 | Pending |

---
*Created: 2026-01-19*
